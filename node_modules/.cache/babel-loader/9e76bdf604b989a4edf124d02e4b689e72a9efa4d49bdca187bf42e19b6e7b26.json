{"ast":null,"code":"// Konfiguration\nconst LOG_SITE_ID=\"baumgartnerfensterag.sharepoint.com,35792666-559f-437e-9570-c2b56718a6f7,5936e718-30c3-4cec-a27e-3fe2e1cf9514\";const LOG_LIST_ID=\"46579bc0-c762-4652-bcd8-e7c67eae8799\";export const logToSharePoint=async(accessToken,entry)=>{// Lokale Zeit berechnen (Browser-Zeit)\nconst now=new Date();// Zeitzonen-Offset abziehen (Offset ist negativ für UTC+1, daher minus mal minus = plus)\nconst localDate=new Date(now.getTime()-now.getTimezoneOffset()*60000);// Formatieren zu \"YYYY-MM-DD HH:mm:ss\"\nconst localTimeString=localDate.toISOString().slice(0,19).replace('T',' ');const item={fields:{Title:\"Upload by \".concat(entry.userEmail),SourceUrl:window.location.href,Logtime:localTimeString,PhotoCount:entry.photoCount,TotalSizeMB:entry.totalSizeMB,TargetTeam:entry.targetTeamName,Status:entry.status,ErrorMessage:entry.errorMessage||\"\"}};try{const response=await fetch(\"https://graph.microsoft.com/v1.0/sites/\".concat(LOG_SITE_ID,\"/lists/\").concat(LOG_LIST_ID,\"/items\"),{method:\"POST\",headers:{Authorization:\"Bearer \".concat(accessToken),\"Content-Type\":\"application/json\"},body:JSON.stringify(item)});if(!response.ok){const errText=await response.text();console.error(\"Logging failed (API Error):\",response.status,errText);}else{console.log(\"Log entry created successfully.\");}}catch(e){// Fallback: Wenn Logging fehlschlägt, nur Konsole (damit die App nicht abstürzt)\nconsole.error(\"Logging failed (Network/Code):\",e);}};","map":{"version":3,"names":["LOG_SITE_ID","LOG_LIST_ID","logToSharePoint","accessToken","entry","now","Date","localDate","getTime","getTimezoneOffset","localTimeString","toISOString","slice","replace","item","fields","Title","concat","userEmail","SourceUrl","window","location","href","Logtime","PhotoCount","photoCount","TotalSizeMB","totalSizeMB","TargetTeam","targetTeamName","Status","status","ErrorMessage","errorMessage","response","fetch","method","headers","Authorization","body","JSON","stringify","ok","errText","text","console","error","log","e"],"sources":["/home/vsts/work/1/s/src/utils/Logger.ts"],"sourcesContent":["export interface LogEntry {\n    userEmail: string;\n    sourceUrl: string;\n    photoCount: number;\n    totalSizeMB: number;\n    targetTeamName: string;\n    status: 'Success' | 'Error';\n    errorMessage?: string;\n}\n\n// Konfiguration\nconst LOG_SITE_ID = \"baumgartnerfensterag.sharepoint.com,35792666-559f-437e-9570-c2b56718a6f7,5936e718-30c3-4cec-a27e-3fe2e1cf9514\"; \nconst LOG_LIST_ID = \"46579bc0-c762-4652-bcd8-e7c67eae8799\";\n\nexport const logToSharePoint = async (accessToken: string, entry: LogEntry) => {\n    // Lokale Zeit berechnen (Browser-Zeit)\n    const now = new Date();\n    // Zeitzonen-Offset abziehen (Offset ist negativ für UTC+1, daher minus mal minus = plus)\n    const localDate = new Date(now.getTime() - (now.getTimezoneOffset() * 60000));\n    // Formatieren zu \"YYYY-MM-DD HH:mm:ss\"\n    const localTimeString = localDate.toISOString().slice(0, 19).replace('T', ' ');\n\n    const item = {\n        fields: {\n            Title: `Upload by ${entry.userEmail}`,\n            SourceUrl: window.location.href,\n            Logtime: localTimeString,\n            PhotoCount: entry.photoCount,\n            TotalSizeMB: entry.totalSizeMB,\n            TargetTeam: entry.targetTeamName,\n            Status: entry.status,\n            ErrorMessage: entry.errorMessage || \"\"\n        }\n    };\n\n    try {\n        const response = await fetch(`https://graph.microsoft.com/v1.0/sites/${LOG_SITE_ID}/lists/${LOG_LIST_ID}/items`, {\n            method: \"POST\",\n            headers: {\n                Authorization: `Bearer ${accessToken}`,\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify(item)\n        });\n        \n        if (!response.ok) {\n            const errText = await response.text();\n            console.error(\"Logging failed (API Error):\", response.status, errText);\n        } else {\n            console.log(\"Log entry created successfully.\");\n        }\n    } catch (e) {\n        // Fallback: Wenn Logging fehlschlägt, nur Konsole (damit die App nicht abstürzt)\n        console.error(\"Logging failed (Network/Code):\", e);\n    }\n};"],"mappings":"AAUA;AACA,KAAM,CAAAA,WAAW,CAAG,+GAA+G,CACnI,KAAM,CAAAC,WAAW,CAAG,sCAAsC,CAE1D,MAAO,MAAM,CAAAC,eAAe,CAAG,KAAAA,CAAOC,WAAmB,CAAEC,KAAe,GAAK,CAC3E;AACA,KAAM,CAAAC,GAAG,CAAG,GAAI,CAAAC,IAAI,CAAC,CAAC,CACtB;AACA,KAAM,CAAAC,SAAS,CAAG,GAAI,CAAAD,IAAI,CAACD,GAAG,CAACG,OAAO,CAAC,CAAC,CAAIH,GAAG,CAACI,iBAAiB,CAAC,CAAC,CAAG,KAAM,CAAC,CAC7E;AACA,KAAM,CAAAC,eAAe,CAAGH,SAAS,CAACI,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAE,EAAE,CAAC,CAACC,OAAO,CAAC,GAAG,CAAE,GAAG,CAAC,CAE9E,KAAM,CAAAC,IAAI,CAAG,CACTC,MAAM,CAAE,CACJC,KAAK,cAAAC,MAAA,CAAeb,KAAK,CAACc,SAAS,CAAE,CACrCC,SAAS,CAAEC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAC/BC,OAAO,CAAEb,eAAe,CACxBc,UAAU,CAAEpB,KAAK,CAACqB,UAAU,CAC5BC,WAAW,CAAEtB,KAAK,CAACuB,WAAW,CAC9BC,UAAU,CAAExB,KAAK,CAACyB,cAAc,CAChCC,MAAM,CAAE1B,KAAK,CAAC2B,MAAM,CACpBC,YAAY,CAAE5B,KAAK,CAAC6B,YAAY,EAAI,EACxC,CACJ,CAAC,CAED,GAAI,CACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,2CAAAlB,MAAA,CAA2CjB,WAAW,YAAAiB,MAAA,CAAUhB,WAAW,WAAU,CAC7GmC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACLC,aAAa,WAAArB,MAAA,CAAYd,WAAW,CAAE,CACtC,cAAc,CAAE,kBACpB,CAAC,CACDoC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC3B,IAAI,CAC7B,CAAC,CAAC,CAEF,GAAI,CAACoB,QAAQ,CAACQ,EAAE,CAAE,CACd,KAAM,CAAAC,OAAO,CAAG,KAAM,CAAAT,QAAQ,CAACU,IAAI,CAAC,CAAC,CACrCC,OAAO,CAACC,KAAK,CAAC,6BAA6B,CAAEZ,QAAQ,CAACH,MAAM,CAAEY,OAAO,CAAC,CAC1E,CAAC,IAAM,CACHE,OAAO,CAACE,GAAG,CAAC,iCAAiC,CAAC,CAClD,CACJ,CAAE,MAAOC,CAAC,CAAE,CACR;AACAH,OAAO,CAACC,KAAK,CAAC,gCAAgC,CAAEE,CAAC,CAAC,CACtD,CACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}